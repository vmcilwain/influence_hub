<header class="header-container">
  <h1 class="header"><%= @campaign.name %></h1>
  <div class="actions">
    <%= link_to :Campaigns, campaigns_path %> | 
    <%= link_to :Edit, edit_campaign_path(@campaign) %>
    <%= button_to :Delete, @campaign, method: :delete, data: { turbo_confirm: t('form.confirmation') } %>
  </div>
</header>

<main class="content-wrapper">
  <p style="color: green"><%= notice %></p>
  <section>
    <header class="subheader-container">
      <h2 class="subheader">Details</h2>
    </header>

    <div class="content-row">
      <div class="data-section">
        <div class="label">Rate</div>
        <div class="value">
          <%= number_to_currency(@campaign.rate) %>
        </div>
      </div>

      <div class="data-section">
        <div class="label">Status</div>
        <div class="value">
          <%= @campaign.status.titleize %>
        </div>
      </div>
    </div>

    <div class="content-row">
      <div class="data-section">
        <div class="label">Description</div>
        <div class="value">
          <%= @campaign.description %>
        </div>
      </div>
    </div>
  </section>

  <section>
    <header class="subheader-container">
      <h2 class="subheader">Tasks</h2>
      <div class="actions">
        <%= link_to :New, new_campaign_task_path(@campaign) %>
      </div>
    </header>

    <div class="kanban-container" data-controller="kanban">
      <div class="kanban-column">
        <h3>Abandoned</h3>
        <div class="kanban-items" data-kanban-target="items" data-status="abandoned">
          <% @tasks.where(status: 'abandoned').each do |task| %>
            <div class="kanban-item" data-task-id="<%= task.id %>" data-campaign-id="<%= task.campaign.id %>">
              <%= link_to edit_campaign_task_path(@campaign, task), 
                class: "kanban-item",
                data: { 
                  task_id: task.id,
                  campaign_id: task.campaign.id,
                  turbo_frame: "task-edit-modal" 
                } do %>
                <%= task.description %>
              <% end %>
            </div>
          <% end %>
        </div>
      </div>

      <div class="kanban-column">
        <h3>To Do</h3>
        <div class="kanban-items" data-kanban-target="items" data-status="not_started">
          <% @tasks.where(status: 'not_started').each do |task| %>
            <div class="kanban-item" data-task-id="<%= task.id %>" data-campaign-id="<%= task.campaign.id %>">
              <%= link_to edit_campaign_task_path(@campaign, task), 
                class: "kanban-item",
                data: { 
                  task_id: task.id,
                  campaign_id: task.campaign.id,
                  turbo_frame: "task-edit-modal" 
                } do %>
                <%= task.description %>
              <% end %>
            </div>
          <% end %>
        </div>
      </div>

      <div class="kanban-column">
        <h3>In Progress</h3>
        <div class="kanban-items" data-kanban-target="items" data-status="in_progress">
          <% @tasks.where(status: 'in_progress').each do |task| %>
            <div class="kanban-item" data-task-id="<%= task.id %>" data-campaign-id="<%= task.campaign.id %>">
              <%= link_to edit_campaign_task_path(@campaign, task), 
                class: "kanban-item",
                data: { 
                  task_id: task.id,
                  campaign_id: task.campaign.id,
                  turbo_frame: "task-edit-modal" 
                } do %>
                <%= task.description %>
              <% end %>
            </div>
          <% end %>
        </div>
      </div>

      <div class="kanban-column">
        <h3>Done</h3>
        <div class="kanban-items" data-kanban-target="items" data-status="complete">
          <% @tasks.where(status: 'complete').each do |task| %>
            <div class="kanban-item" data-task-id="<%= task.id %>" data-campaign-id="<%= task.campaign.id %>">
              <%= link_to edit_campaign_task_path(@campaign, task), 
                class: "kanban-item",
                data: { 
                  task_id: task.id,
                  campaign_id: task.campaign.id,
                  turbo_frame: "task-edit-modal" 
                } do %>
                <%= task.description %>
              <% end %>
            </div>
          <% end %>
        </div>
      </div>
    </div>
  </section>
</main>

<%= turbo_frame_tag "task-edit-modal" %>